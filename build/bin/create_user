#!/bin/bash

echo "Create User: $WORKSPACE_USER ..."

sudo addgroup -gid 1000 g1000

useradd -rm \
  -d /home/$WORKSPACE_USER \
  -s /bin/zsh \
  -G sudo \
  -u 1000 \
  -g 1000 \
  -p $(openssl passwd -1 "$WORKSPACE_USER") \
  $WORKSPACE_USER
  # -G g1000
  # -g root \
  # -u 1001 \

# User without a password 
#   - how can one login into that account from a non-root account
# Reference: https://unix.stackexchange.com/questions/192945/user-without-a-password-how-can-one-login-into-that-account-from-a-non-root-ac
passwd -d $WORKSPACE_USER

# Visit Host Volume Permission Denied
#   https://github.com/cdr/code-server/issues/910
#   https://github.com/cdr/code-server/issues/1307
echo "$WORKSPACE_USER ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers.d/nopasswd

# @TODO
sudo chown -R $WORKSPACE_USER /usr/local/lib/zmicro